{
  "rules": {
    "users": {
      "$userId": {
        ".read": "auth != null && $userId === auth.uid",
        ".write": "auth != null && $userId === auth.uid",
        "tasks": {
          "$taskId": {
            ".read": "auth != null && $userId === auth.uid",
            ".write": "auth != null && $userId === auth.uid",
            ".validate": "(!data.exists() && newData.hasChildren(['id', 'title', 'status']) && newData.child('id').val() == $taskId && newData.child('title').isString() && newData.child('status').isString()) || (data.exists() && (!newData.hasChild('id') || newData.child('id').val() == $taskId) && (!newData.hasChild('title') || newData.child('title').isString()) && (!newData.hasChild('status') || newData.child('status').isString()) && (!newData.hasChild('description') || newData.child('description').isString() || newData.child('description').val() == null) && (!newData.hasChild('due_date') || newData.child('due_date').isString() || newData.child('due_date').val() == null) && (!newData.hasChild('created_at') || newData.child('created_at').isString() || newData.child('created_at').val() == null) && (!newData.hasChild('updated_at') || newData.child('updated_at').isString() || newData.child('updated_at').val() == null))",
            "subtasks": {
              "$subtaskId": {
                ".read": "auth != null && $userId === auth.uid",
                ".write": "auth != null && $userId === auth.uid",
                ".validate": "(!data.exists() && newData.hasChildren(['id', 'task_id', 'title', 'completed']) && newData.child('id').val() == $subtaskId && newData.child('task_id').val() == $taskId && newData.child('title').isString() && newData.child('completed').isBoolean()) || (data.exists() && (!newData.hasChild('id') || newData.child('id').val() == $subtaskId) && (!newData.hasChild('task_id') || newData.child('task_id').val() == $taskId) && (!newData.hasChild('title') || newData.child('title').isString()) && (!newData.hasChild('completed') || newData.child('completed').isBoolean()) && (!newData.hasChild('created_at') || newData.child('created_at').isString() || newData.child('created_at').val() == null) && (!newData.hasChild('updated_at') || newData.child('updated_at').isString() || newData.child('updated_at').val() == null))"
              }
            }
          }
        },
        "habits": {
          "$habitId": {
            ".read": "auth != null && $userId === auth.uid",
            ".write": "auth != null && $userId === auth.uid",
            ".validate": "(!data.exists() && newData.hasChildren(['id', 'title']) && newData.child('id').val() == $habitId && newData.child('title').isString()) || (data.exists() && (!newData.hasChild('id') || newData.child('id').val() == $habitId) && (!newData.hasChild('title') || newData.child('title').isString()) && (!newData.hasChild('description') || newData.child('description').isString() || newData.child('description').val() == null) && (!newData.hasChild('created_at') || newData.child('created_at').isString() || newData.child('created_at').val() == null) && (!newData.hasChild('updated_at') || newData.child('updated_at').isString() || newData.child('updated_at').val() == null))",
            "completions": {
              "$date": {
                ".read": "auth != null && $userId === auth.uid",
                ".write": "auth != null && $userId === auth.uid",
                ".validate": "$date.matches(/^\\d{4}-\\d{2}-\\d{2}$/) && (newData.val() === true || newData.val() === null)"
              }
            }
          }
        },
        "goals": {
          "$goalId": {
            ".read": "auth != null && $userId === auth.uid",
            ".write": "auth != null && $userId === auth.uid",
            ".validate": "(!data.exists() && newData.hasChildren(['id', 'title']) && newData.child('id').val() == $goalId && newData.child('title').isString()) || (data.exists() && (!newData.hasChild('id') || newData.child('id').val() == $goalId) && (!newData.hasChild('title') || newData.child('title').isString()) && (!newData.hasChild('description') || newData.child('description').isString() || newData.child('description').val() == null) && (!newData.hasChild('target_value') || newData.child('target_value').isNumber() || newData.child('target_value').val() == null) && (!newData.hasChild('current_value') || newData.child('current_value').isNumber() || newData.child('current_value').val() == null) && (!newData.hasChild('unit') || newData.child('unit').isString() || newData.child('unit').val() == null) && (!newData.hasChild('period') || newData.child('period').isString() || newData.child('period').val() == null) && (!newData.hasChild('created_at') || newData.child('created_at').isString() || newData.child('created_at').val() == null) && (!newData.hasChild('updated_at') || newData.child('updated_at').isString() || newData.child('updated_at').val() == null))"
          }
        },
        "rewards": {
          "$rewardId": {
            ".read": "auth != null && $userId === auth.uid",
            ".write": "auth != null && $userId === auth.uid",
            ".validate": "(!data.exists() && newData.hasChildren(['id', 'name', 'target_points', 'status']) && newData.child('id').val() == $rewardId && newData.child('name').isString() && newData.child('target_points').isNumber() && newData.child('status').isString()) || (data.exists() && (!newData.hasChild('id') || newData.child('id').val() == $rewardId) && (!newData.hasChild('name') || newData.child('name').isString()) && (!newData.hasChild('description') || newData.child('description').isString() || newData.child('description').val() == null) && (!newData.hasChild('target_points') || newData.child('target_points').isNumber()) && (!newData.hasChild('status') || newData.child('status').isString()) && (!newData.hasChild('created_at') || newData.child('created_at').isString() || newData.child('created_at').val() == null) && (!newData.hasChild('claimed_at') || newData.child('claimed_at').isString() || newData.child('claimed_at').val() == null))"
          }
        },
        "points": {
          ".read": "auth != null && $userId === auth.uid",
          ".write": "auth != null && $userId === auth.uid",
          ".validate": "(!data.exists() && newData.hasChildren(['total_points']) && newData.child('total_points').isNumber() && newData.child('total_points').val() >= 0) || (data.exists() && (!newData.hasChild('total_points') || (newData.child('total_points').isNumber() && newData.child('total_points').val() >= 0)) && (!newData.hasChild('last_updated') || newData.child('last_updated').isString()))"
        },
        "user_settings": {
          ".read": "auth != null && $userId === auth.uid",
          ".write": "auth != null && $userId === auth.uid",
          ".validate": "(!data.exists() && newData.hasChildren(['user_name']) && newData.child('user_name').isString()) || (data.exists() && (!newData.hasChild('user_name') || newData.child('user_name').isString()) && (!newData.hasChild('last_updated') || newData.child('last_updated').isString()))"
        }
      }
    },
    ".read": false,
    ".write": false
  }
}
